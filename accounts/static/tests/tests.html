<!DOCTYPE html>
<html>
<head>
    <meta charset= "utf-8" >
    <title>Javascript tests</title>
    <link rel="stylesheet" href="../../../superlists/static/tests/qunit.css" >
</head>

<body>
    <div id="qunit" ></div>
    <div id="qunit-fixture">       
        <a id="id_login"> Sign in</a>
    </div>

    <script src="../../../superlists/static/jquery-3.1.1.min.js"></script>
    <script src="../../../superlists/static/tests/qunit.js" ></script>
    <script src=../accounts.js></script>
    <script>
        test( " initialize binds sign in button to navigator.id.request " , function () {
            var requestWasCalled = false; // ➊
            var mockRequestFunction = function () { requestWasCalled = true; }; // ➋
            var mockNavigator = { // ➌
                id: {
                    request: mockRequestFunction
                }
            };
            // var mockNavigator = {
            //     id: {
            //         request: mockRequestFunction,
            //         doSomethingElse: function () { console.log( " called me! " );}
            //     }
            // };

            Superlists.Accounts.initialize(mockNavigator);
            equal(requestWasCalled, false, 'check request not called before click');
            $('#id_login').trigger('click');
            equal(requestWasCalled, true, 'check request called after click');

        });
    </script>

</body>
</html>